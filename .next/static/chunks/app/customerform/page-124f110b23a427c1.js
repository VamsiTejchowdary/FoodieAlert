(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[497],{3612:(e,t,a)=>{Promise.resolve().then(a.bind(a,9704))},9704:(e,t,a)=>{"use strict";a.d(t,{default:()=>S});var o=a(5155),r=a(2115);class s{constructor(e=0,t="Network Error"){this.status=e,this.text=t}}let i={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:(()=>{if("undefined"!=typeof localStorage)return{get:e=>Promise.resolve(localStorage.getItem(e)),set:(e,t)=>Promise.resolve(localStorage.setItem(e,t)),remove:e=>Promise.resolve(localStorage.removeItem(e))}})()},n=e=>e?"string"==typeof e?{publicKey:e}:"[object Object]"===e.toString()?e:{}:{},l=async(e,t,a={})=>{let o=await fetch(i.origin+e,{method:"POST",headers:a,body:t}),r=await o.text(),n=new s(o.status,r);if(o.ok)return n;throw n},c=(e,t,a)=>{if(!e||"string"!=typeof e)throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!t||"string"!=typeof t)throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!a||"string"!=typeof a)throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},d=e=>{if(e&&"[object Object]"!==e.toString())throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"},u=e=>e.webdriver||!e.languages||0===e.languages.length,f=()=>new s(451,"Unavailable For Headless Browser"),h=(e,t)=>{if(!Array.isArray(e))throw"The BlockList list has to be an array";if("string"!=typeof t)throw"The BlockList watchVariable has to be a string"},m=e=>!e.list?.length||!e.watchVariable,g=(e,t)=>e instanceof FormData?e.get(t):e[t],p=(e,t)=>{if(m(e))return!1;h(e.list,e.watchVariable);let a=g(t,e.watchVariable);return"string"==typeof a&&e.list.includes(a)},b=()=>new s(403,"Forbidden"),y=(e,t)=>{if("number"!=typeof e||e<0)throw"The LimitRate throttle has to be a positive number";if(t&&"string"!=typeof t)throw"The LimitRate ID has to be a non-empty string"},w=async(e,t,a)=>{let o=Number(await a.get(e)||0);return t-Date.now()+o},x=async(e,t,a)=>{if(!t.throttle||!a)return!1;y(t.throttle,t.id);let o=t.id||e;return await w(o,t.throttle,a)>0||(await a.set(o,Date.now().toString()),!1)},v=()=>new s(429,"Too Many Requests"),j={send:async(e,t,a,o)=>{let r=n(o),s=r.publicKey||i.publicKey,h=r.blockHeadless||i.blockHeadless,m=r.storageProvider||i.storageProvider,g={...i.blockList,...r.blockList},y={...i.limitRate,...r.limitRate};return h&&u(navigator)?Promise.reject(f()):(c(s,e,t),d(a),a&&p(g,a))?Promise.reject(b()):await x(location.pathname,y,m)?Promise.reject(v()):l("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:s,service_id:e,template_id:t,template_params:a}),{"Content-type":"application/json"})}},k=async(e,t,a,o,r)=>{try{console.log("Sending email to:",e,t,a);let s=await j.send("FoodeAlert","foodealert",{user_name:t,email:e,food_truck_name:o,food_truck_location:r,unsubscribe_code:a},"Wl5215FfRpqukGjrP");200===s.status?console.log("Email sent successfully"):console.error("Failed to send email:",s)}catch(e){console.error("Error sending email:",e)}},S=()=>{let[e,t]=(0,r.useState)(""),[a,s]=(0,r.useState)(""),[i,n]=(0,r.useState)(""),[l,c]=(0,r.useState)(""),[d,u]=(0,r.useState)(""),[f,h]=(0,r.useState)([]),[m,g]=(0,r.useState)(""),[p,b]=(0,r.useState)([]);(0,r.useEffect)(()=>{let e=async()=>{try{let e=await fetch("api/locations?email=".concat(encodeURIComponent(i)),{method:"GET",headers:{"Content-Type":"application/json"}}),t=await e.json();h(t.locations)}catch(e){console.error("Error fetching locations:",e)}};i&&e()},[i]);let y=async o=>{o.preventDefault();let r={name:e,phone:a,email:i,favfood:d,code:Math.floor(1e3+9e3*Math.random()),location_id:l};try{(await fetch("/api/customersubscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).ok?(console.log("selectedLocationDetails: ",p),await k(r.email,r.name,r.code,p.name,p.address),g("Thank you for subscribing!"),t(""),s(""),n(""),u(""),c(""),setTimeout(()=>g(""),5e3)):alert("An error occurred. Please try again.")}catch(e){console.error("Error submitting form:",e),alert("An error occurred. Please try again.")}};return(0,o.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-start py-8 sm:py-4",style:{background:"linear-gradient(to right, #001f3d, #243b4a)"},children:[(0,o.jsx)("div",{className:"flex justify-center mb-0 mt-4 sm:mt-2",style:{marginTop:"-40px"},children:(0,o.jsx)("img",{src:"foodeehero.png",alt:"Logo",className:"w-64 h-64 md:w-72 md:h-72 object-contain"})}),(0,o.jsxs)("div",{className:"w-full max-w-md p-8 space-y-6 rounded-lg shadow-lg",style:{background:"linear-gradient(to right, #001f3d, #243b4a)"},children:[(0,o.jsx)("h2",{className:"text-2xl text-center text-[#ff6f61] font-bold mb-1",style:{background:"linear-gradient(to right, #ff6f61, #f86e4f)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"Subscribe to Food Truck Notifications"}),m&&(0,o.jsx)("div",{className:"bg-[#d4edda] text-[#155724] p-4 mb-4 rounded-md border border-[#c3e6cb] text-center",children:m}),(0,o.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[(0,o.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),required:!0,placeholder:"Your Name",className:"w-full px-4 py-2 border-none bg-[#243b4a] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#ff6f61]"}),(0,o.jsx)("input",{type:"number",value:a,onChange:e=>s(e.target.value),required:!0,placeholder:"Phone Number",className:"w-full px-4 py-2 border-none bg-[#243b4a] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#ff6f61]"}),(0,o.jsx)("input",{type:"email",value:i,onChange:e=>n(e.target.value),required:!0,placeholder:"Email Address",className:"w-full px-4 py-2 border-none bg-[#243b4a] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#ff6f61]"}),(0,o.jsx)("input",{type:"text",value:d,onChange:e=>u(e.target.value),required:!0,placeholder:"Favourite Food",className:"w-full px-4 py-2 border-none bg-[#243b4a] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#ff6f61]"}),(0,o.jsxs)("select",{value:l,onChange:e=>{let t=e.target.value;c(t),b(f.find(e=>e._id===t))},required:!0,className:"w-full px-4 py-2 border-none bg-[#243b4a] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#ff6f61]",children:[(0,o.jsx)("option",{value:"",children:"Select a location"}),f.map(e=>(0,o.jsxs)("option",{value:e._id,children:[e.name," - ",e.address]},e._id))]}),(0,o.jsx)("button",{type:"submit",className:"w-full py-3 bg-[#ff6f61] text-white font-semibold rounded-md hover:bg-[#f86e4f] focus:outline-none focus:ring-2 focus:ring-[#f86e4f]",children:"Subscribe"})]})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,517,358],()=>t(3612)),_N_E=e.O()}]);