(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[152],{3509:(e,t,r)=>{Promise.resolve().then(r.bind(r,3855))},3855:(e,t,r)=>{"use strict";r.d(t,{default:()=>a});var o=r(5155),s=r(2115),n=r(2110);function a(){let[e,t]=(0,s.useState)(""),[r,a]=(0,s.useState)(""),[i,l]=(0,s.useState)(""),[c,d]=(0,s.useState)(""),[u,f]=(0,s.useState)([]),[h,g]=(0,s.useState)(""),[p,b]=(0,s.useState)(null),m=async e=>{try{let t=await fetch("api/findcustomerbyemail",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})}),r=(await t.json()).customer;b(r),(null==r?void 0:r._id)?y(r._id):f([])}catch(e){n.oR.error("Error fetching user data."),console.error("Error fetching user:",e)}},y=async e=>{try{let t=await fetch("/api/fetchlocationsusingcustomerid",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customerId:e})}),r=(await t.json()).locationIds;r&&r.length>0?x(r):(f([]),n.oR.info("No locations found for this customer."))}catch(e){n.oR.error("Error fetching locations."),console.error("Error fetching locations:",e)}},x=async e=>{try{let t=await fetch("/api/fetchlocationsbyids",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({locationIds:e})}),r=await t.json();f(r.locations||[])}catch(e){n.oR.error("Error fetching location details."),console.error("Error fetching location details:",e)}},j=async o=>{if(o.preventDefault(),!e||!r||!i||!h){d("All fields are required.");return}try{let e=await fetch("/api/unsubscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customer_id:p._id,location_id:h._id,code:i})}),r=await e.json();console.log(r),200===e.status?(l(""),t(""),a(""),f([]),n.oR.success("Successfully unsubscribed from notifications!")):n.oR.error(r.message||"Error during unsubscribe process.")}catch(e){n.oR.error("Error during unsubscribe process."),console.error("Error unsubscribing:",e)}};return(0,o.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-start py-8",style:{background:"linear-gradient(to right, #001f3d, #243b4a)"},children:[(0,o.jsx)("div",{className:"flex justify-center mb-0 mt-0",children:(0,o.jsx)("img",{src:"foodeehero.png",alt:"Logo",className:"w-64 h-64 md:w-72 md:h-72 object-contain",style:{marginTop:"-40px"}})}),(0,o.jsxs)("div",{className:"w-full max-w-md p-8 space-y-6 rounded-lg shadow-lg",style:{background:"linear-gradient(to right, #001f3d, #243b4a)"},children:[(0,o.jsx)("h2",{className:"text-2xl text-center text-[#ff6f61] font-bold mb-1",style:{background:"linear-gradient(to right, #ff6f61, #f86e4f)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"Unsubscribe from Food Truck Notifications"}),c&&(0,o.jsx)("div",{className:"bg-[#d4edda] text-[#155724] p-4 mb-4 rounded-md border border-[#c3e6cb] text-center",children:c}),(0,o.jsxs)("form",{onSubmit:j,className:"space-y-4",children:[(0,o.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),required:!0,placeholder:"Your Name",className:"w-full px-4 py-2 border-none bg-[#243b4a] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#ff6f61]"}),(0,o.jsx)("input",{type:"email",value:r,onChange:e=>{let t=e.target.value;a(t),m(t)},required:!0,placeholder:"Email Address",className:"w-full px-4 py-2 border-none bg-[#243b4a] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#ff6f61]"}),(0,o.jsxs)("select",{value:h?h._id:"",onChange:e=>{g(u.find(t=>t._id===e.target.value))},required:!0,className:"w-full px-4 py-2 border-none bg-[#243b4a] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#ff6f61]",children:[(0,o.jsx)("option",{value:"",children:"Select a location"}),u.map(e=>(0,o.jsxs)("option",{value:e._id,children:[e.name," - ",e.address]},e._id))]}),(0,o.jsx)("input",{type:"text",value:i,onChange:e=>l(e.target.value),required:!0,placeholder:"Code",className:"w-full px-4 py-2 border-none bg-[#243b4a] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#ff6f61]"}),(0,o.jsx)("button",{type:"submit",className:"w-full py-3 bg-[#ff6f61] text-white font-semibold rounded-md hover:bg-[#ff6f61] focus:outline-none focus:ring-2 focus:ring-[#ff6f61]",children:"Unsubscribe"})]})]}),(0,o.jsx)(n.N9,{})]})}r(5716)}},e=>{var t=t=>e(e.s=t);e.O(0,[797,27,441,517,358],()=>t(3509)),_N_E=e.O()}]);